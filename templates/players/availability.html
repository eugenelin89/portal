{% extends "base.html" %}

{% block title %}Availability | BC Baseball Transfer Portal{% endblock %}

{% block content %}
  {% if availability.is_committed %}
    <div class="alert alert-warning" role="alert">
      <div class="fw-semibold">Committed status is active.</div>
      <div class="small">You will not appear in open player searches while committed.</div>
    </div>
  {% endif %}

  <div class="row g-4">
    <div class="col-12 col-lg-8">
      <div class="card shadow-sm">
        <div class="card-body p-4">
          {% include "partials/_form_errors.html" %}
          <form method="post">
            {% csrf_token %}
            <div class="form-check form-switch mb-3">
              {{ form.is_open }}
              <label class="form-check-label" for="id_is_open">Open to opportunities</label>
            </div>
            <div class="mb-3">
              <label class="form-label" for="id_positions">Positions</label>
              {{ form.positions }}
            </div>
            <div class="mb-3">
              <label class="form-label" for="id_levels">Levels</label>
              {{ form.levels }}
            </div>
            <div class="mb-3">
              <label class="form-label" for="id_expires_at">Open until (optional)</label>
              {{ form.expires_at }}
              <div class="form-text">Leave blank to stay open indefinitely.</div>
            </div>
            <div class="mb-3">
              <label class="form-label" for="id_allowed_teams">Allow-listed teams</label>
              {{ form.allowed_teams }}
              <div class="form-text">Only selected teams can view your profile.</div>
            </div>
            <div class="d-flex flex-column flex-sm-row gap-2">
              <button class="btn btn-primary" type="submit">Save availability</button>
              <a class="btn btn-outline-secondary" href="{% url 'player_dashboard' %}">Back to dashboard</a>
            </div>
          </form>
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-4">
      <div class="card shadow-sm">
        <div class="card-body p-4">
          <h2 class="h6 text-uppercase text-muted">Committed status</h2>
          <p class="text-muted">Committed players are hidden from coach searches.</p>
          <form method="post" action="{% url 'player_availability_commit' %}">
            {% csrf_token %}
            {% if availability.is_committed %}
              <input type="hidden" name="action" value="uncommit">
              <button class="btn btn-outline-secondary w-100" type="submit">Clear committed status</button>
            {% else %}
              <input type="hidden" name="action" value="commit">
              <button class="btn btn-outline-danger w-100" type="submit">Mark as committed</button>
            {% endif %}
          </form>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
